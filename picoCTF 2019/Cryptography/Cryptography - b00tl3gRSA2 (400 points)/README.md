
# Cryptography - b00tl3gRSA2 (400 points)

## Challenge

*In RSA d is alot bigger than e, why dont we use d to encrypt instead of e? Connect with nc 2019shell1.picoctf.com 40480.*

```bash
root@kali:~/chal# nc 2019shell1.picoctf.com 40480
c: 53070692502729776389311485553694966769597438702486876831118275746093016690606622959099207287477553545956407741707687082136438559820252284576638755566364601521433971795806958811034131524333390609340401974750812458690655354028702224794535214705997222166982861102968055709360043179939669834273466234182437948416
n: 82298133814041275566241990436750350183125193828306240485634890096303176445482268876837738847330405040980762813103037358111205167315126637733157325753104927691911273826955538480763342358294872454849188874235193333889956025922949012607027774970615845501981616312983248904664197219438823629311660568285568675071
e: 22074841605765164459449897765958686022691880652269640073500095106625471698965970437858470958347516520673830500198945537913497347089927997386379795068645668923205881172755624222938959212465708086835747508972493044746251691698153322770239856362635887913630309513830593593534361788951036547437580415590099222177
```

## Flag

picoCTF{bad_1d3a5_9093280}

## Walkthrough

`e` is a big prime number, however the public exponent is generally a short and well known value (very often, it is set to 65537, but other well known values are: 3, 5, 17 and 257).

Considering the description of the challenge, `e` and `d` have been exchanged to encrypt the message. So `d` is probably a little number. There are two ways to solve this challenge:

* By guessing `d` using well-know values of the public exponent.
* Using [Wiener's attack](https://en.wikipedia.org/wiki/Wiener%27s_attack) to which the private exponent is vulnerable.

For more fun, let's try Wiener's attack (using [this](https://github.com/orisano/owiener) implementation):

```python
import gmpy2
import owiener
from Crypto.PublicKey import RSA


c = 53070692502729776389311485553694966769597438702486876831118275746093016690606622959099207287477553545956407741707687082136438559820252284576638755566364601521433971795806958811034131524333390609340401974750812458690655354028702224794535214705997222166982861102968055709360043179939669834273466234182437948416
n = 82298133814041275566241990436750350183125193828306240485634890096303176445482268876837738847330405040980762813103037358111205167315126637733157325753104927691911273826955538480763342358294872454849188874235193333889956025922949012607027774970615845501981616312983248904664197219438823629311660568285568675071
e = 22074841605765164459449897765958686022691880652269640073500095106625471698965970437858470958347516520673830500198945537913497347089927997386379795068645668923205881172755624222938959212465708086835747508972493044746251691698153322770239856362635887913630309513830593593534361788951036547437580415590099222177
d = owiener.attack(e,n)
print("Private exponent is: {0}".format(d))

privkey = RSA.construct((n, e, d, 0, 0))
decryption = privkey.decrypt(c)
print(hex(decryption))
```

Which gives us the private exponent `d` and the decrypted message:

```bash
root@kali:~/chal# python decrypt.py
Private exponent is: 65537
0x7069636f4354467b6261645f31643361355f393039333238307d
```

We just have to convert `7069636f4354467b6261645f31643361355f393039333238307d` to ASCII: `picoCTF{bad_1d3a5_9093280}`
